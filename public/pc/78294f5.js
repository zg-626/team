(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{460:function(t,e,n){t.exports=n.p+"img/f.95f275f.png"},522:function(t,e,n){var content=n(646);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(3).default)("6d7efbf7",content,!0,{sourceMap:!1})},645:function(t,e,n){"use strict";var o=n(522);n.n(o).a},646:function(t,e,n){(e=n(2)(!1)).push([t.i,".user-index .user-content[data-v-5abf7d3a]{padding:34px 0}.user-index .user-content .item[data-v-5abf7d3a]{padding-left:16px;position:relative;font-size:14px;border-bottom:1px dashed #ddd;margin-right:54px}.user-index .user-content .item .edit-txt[data-v-5abf7d3a]{position:absolute;right:0;bottom:16px;color:#e93323;cursor:pointer}.user-index .user-content .item .label[data-v-5abf7d3a]{display:inline-block;width:80px;color:#777}.user-index .user-content .item.user-info[data-v-5abf7d3a]{padding-bottom:20px}.user-index .user-content .item.user-info .title[data-v-5abf7d3a]{color:#282828;font-size:18px}.user-index .user-content .item.user-info .info[data-v-5abf7d3a]{margin-top:20px;color:#777;font-size:14px}.user-index .user-content .item.user-info .info img[data-v-5abf7d3a]{width:80px;height:80px;border-radius:50%;vertical-align:-44px;display:inline-block}.user-index .user-content .item.text-info[data-v-5abf7d3a]{height:70px;line-height:70px}.user-index .user-content .item.text-info .edit-txt[data-v-5abf7d3a]{top:0}.user-index .user-content .item.text-info .txt[data-v-5abf7d3a]{color:#282828;width:700px}.user-index .user-content .out-btn[data-v-5abf7d3a]{text-align:right;margin-right:54px}.user-index .user-content .out-btn span[data-v-5abf7d3a]{display:inline-block;width:130px;height:40px;margin-top:38px;line-height:40px;text-align:center;background:#e93323;color:#fff;border-radius:4px;cursor:pointer}.input-item[data-v-5abf7d3a]{display:flex;align-items:center;margin-bottom:20px}.input-item .code-box[data-v-5abf7d3a]{width:115px;height:40px;text-align:center;cursor:pointer;margin-left:30px}.dialog-footer[data-v-5abf7d3a]{display:flex;align-items:center;justify-content:center;padding-top:40px;border-top:1px solid #efefef}.dialog-footer button[data-v-5abf7d3a]{width:190px;height:45px}",""]),t.exports=e},749:function(t,e,n){"use strict";n.r(e);n(239),n(5);var o=n(115),r=n.n(o),c=(n(41),n(25),n(4)),d=n(156),l={name:"index",auth:"guest",components:{Verify:n(157).a},mixins:[d.a],data:function(){return{userInfo:{},fileList:[],upLoadUrl:"/upload/image",myHeaders:{},isPassword:!1,passwordData:{phone:"",code:"",newPassword:""},isPhone:!1,phoneData:{code:"",newPhone:""},keyCode:"",isShowCode:!1,codeUrl:"",codeVal:"",codeKey:"",currentType:0}},fetch:function(t){var e=t.store;e.commit("isBanner",!1),e.commit("isHeader",!0),e.commit("isFooter",!0)},head:function(){return{title:"账户管理-"+this.$store.state.titleCon}},beforeMount:function(){},mounted:function(){var t=this.$cookies.get("auth.strategy");this.myHeaders={Authorization:this.$cookies.get("auth._token.".concat(t))},this.userInfo=this.$auth.user},methods:{again:function(){this.getcaptcha()},getcaptcha:function(){var t=this;t.$axios.post("/api/captcha").then((function(e){t.codeUrl=data.data.captcha,t.codeVal=data.data.code,t.codeKey=data.data.key,t.isShowCode=!0})).catch((function(e){t.$message.error(e)}))},longOut:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$cookies.get("auth.strategy"),e.next=3,t.$auth.logout(n).then((function(e){t.$store.commit("cartNum",0),t.$router.replace({path:"/"})}));case 3:case"end":return e.stop()}}),e)})))()},bindPassword:function(){var t=this;return this.passwordData.code?this.passwordData.newPassword?this.isShowCode&&!this.codeVal?r.a.error("请填写图片验证码"):void this.$axios.post("/api/user/change_pwd",{phone:this.userInfo.phone,sms_code:this.passwordData.code,pwd:this.passwordData.newPassword}).then((function(e){r.a.success(e.message),t.isPassword=!1,t.passwordData.phone="",t.passwordData.code="",t.passwordData.newPassword=""})).catch((function(t){})):r.a.error("请填写新密码"):r.a.error("请填写验证码")},handleClose:function(){this.isPassword=!1,this.isPhone=!1,this.passwordData.phone="",this.passwordData.code="",this.passwordData.newPassword="",this.phoneData.code="",this.phoneData.newPhone=""},getCode:function(t,data){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e,0!=t){n.next=6;break}return n.next=4,e.$axios.post("/api/auth/verify",{phone:o.userInfo.phone,type:"change_pwd",captchaType:"blockPuzzle",captchaVerification:data.captchaVerification}).then((function(t){r.a.success(t.message),o.sendCode()})).catch((function(t){r.a.error(t)}));case 4:n.next=8;break;case 6:return n.next=8,e.$axios.post("/api/auth/verify",{phone:o.phoneData.newPhone,type:"change_phone",code:o.phoneData.code,captchaType:"blockPuzzle",captchaVerification:data.captchaVerification}).then((function(t){r.a.success(t.message),o.sendCode()})).catch((function(t){r.a.error(t)}));case 8:case"end":return n.stop()}}),n)})))()},bindNewPhone:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=t).phoneData.newPhone){e.next=3;break}return e.abrupt("return",r.a.error("请填写新手机号码"));case 3:if(/^1(3|4|5|7|8|9|6)\d{9}$/i.test(n.phoneData.newPhone)){e.next=5;break}return e.abrupt("return",r.a.error("请输入正确的手机号码"));case 5:if(n.phoneData.code){e.next=7;break}return e.abrupt("return",r.a.error("请填写验证码"));case 7:t.$axios.post("/api/user/change/phone",{phone:n.phoneData.newPhone,sms_code:n.phoneData.code}).then((function(e){r.a.success(e.message),t.isPhone=!1,t.phoneData.newPhone="",t.phoneData.code=""})).catch((function(t){return r.a.error(t)}));case 8:case"end":return e.stop()}}),e)})))()},getVerify:function(t){this.currentType=t,this.$refs.verify.show()},verifySuccess:function(t){this.closeModel(t)},closeModel:function(t){this.isShow=!1,this.getCode(this.currentType,t)}}},h=(n(645),n(6)),component=Object(h.a)(l,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"user-index"},[o("div",{staticClass:"user-com-title",staticStyle:{"padding-left":"16px"}},[t._v("账户管理")]),t._v(" "),o("div",{staticClass:"user-content"},[o("div",{staticClass:"item user-info"},[o("div",{staticClass:"title"},[t._v("我的信息")]),t._v(" "),o("div",{staticClass:"info"},[o("span",{staticClass:"label"},[t._v("我的头像：")]),t._v(" "),t.userInfo.avatar?o("img",{attrs:{src:t.userInfo.avatar,alt:"avatar"}}):o("img",{attrs:{src:n(460)}})])]),t._v(" "),o("div",{staticClass:"item text-info"},[o("span",{staticClass:"label"},[t._v("我的昵称：")]),t._v(" "),o("span",{staticClass:"txt line1",staticStyle:{display:"inline-block","vertical-align":"middle"}},[t._v(t._s(t.userInfo.nickname))])]),t._v(" "),o("div",{staticClass:"item text-info"},[o("span",{staticClass:"label"},[t._v("我的ID：")]),t._v(" "),o("span",{staticClass:"txt"},[t._v(t._s(t.userInfo.uid))])]),t._v(" "),o("div",{staticClass:"item text-info"},[o("span",{staticClass:"label"},[t._v("手机号：")]),t._v(" "),o("span",{staticClass:"txt"},[t._v(t._s(t.userInfo.phone))]),t._v(" "),o("div",{staticClass:"edit-txt",on:{click:function(e){t.isPhone=!0}}},[t._v("修改")])]),t._v(" "),o("div",{staticClass:"item text-info"},[o("span",{staticClass:"label"},[t._v("我的密码：")]),t._v(" "),o("span",{staticClass:"txt"},[t._v("******")]),t._v(" "),o("div",{staticClass:"edit-txt",on:{click:function(e){t.isPassword=!0}}},[t._v("修改")])]),t._v(" "),o("div",{staticClass:"out-btn"},[o("span",{on:{click:t.longOut}},[t._v("退出登录")])])]),t._v(" "),o("el-dialog",{attrs:{title:"修改密码",visible:t.isPassword,width:"545px","before-close":t.handleClose},on:{"update:visible":function(e){t.isPassword=e}}},[o("div",{staticClass:"form-box"},[o("div",{staticClass:"input-item"},[o("el-input",{attrs:{placeholder:"请输入手机号码",disabled:""},model:{value:t.userInfo.phone,callback:function(e){t.$set(t.userInfo,"phone",e)},expression:"userInfo.phone"}},[o("template",{slot:"prepend"},[t._v("+86")])],2)],1),t._v(" "),o("div",{staticClass:"input-item"},[o("el-input",{attrs:{placeholder:"请输入验证码"},model:{value:t.passwordData.code,callback:function(e){t.$set(t.passwordData,"code",e)},expression:"passwordData.code"}}),t._v(" "),o("el-button",{staticClass:"code-box",attrs:{plain:"",disabled:t.disabled},on:{click:function(e){return t.getVerify(0)}}},[t._v(t._s(t.text))])],1),t._v(" "),t.isShowCode?o("div",{staticClass:"input-item"},[o("el-input",{staticClass:"verifiCode",attrs:{placeholder:"请输入验证码"},model:{value:t.codeVal,callback:function(e){t.codeVal=e},expression:"codeVal"}}),t._v(" "),o("span",{staticClass:"imageCode",on:{click:t.again}},[o("img",{attrs:{src:t.codeUrl,alt:""}})])],1):t._e(),t._v(" "),o("div",{staticClass:"input-item"},[o("el-input",{attrs:{placeholder:"请输入新密码",type:"password"},model:{value:t.passwordData.newPassword,callback:function(e){t.$set(t.passwordData,"newPassword",e)},expression:"passwordData.newPassword"}})],1)]),t._v(" "),o("div",{staticClass:"dialog-footer"},[o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:t.bindPassword}},[t._v("提 交")]),t._v(" "),o("el-button",{on:{click:t.handleClose}},[t._v("取 消")])],1)])]),t._v(" "),o("el-dialog",{attrs:{title:"修改手机号码",visible:t.isPhone,width:"545px","before-close":t.handleClose},on:{"update:visible":function(e){t.isPhone=e}}},[o("div",{staticClass:"form-box"},[o("div",{staticClass:"input-item"},[o("el-input",{attrs:{placeholder:"请输入新手机号码"},model:{value:t.phoneData.newPhone,callback:function(e){t.$set(t.phoneData,"newPhone",e)},expression:"phoneData.newPhone"}},[o("template",{slot:"prepend"},[t._v("+86")])],2)],1),t._v(" "),o("div",{staticClass:"input-item"},[o("el-input",{attrs:{placeholder:"请输入验证码"},model:{value:t.phoneData.code,callback:function(e){t.$set(t.phoneData,"code",e)},expression:"phoneData.code"}}),t._v(" "),o("el-button",{staticClass:"code-box",attrs:{plain:"",disabled:t.disabled},on:{click:function(e){return t.getVerify(1)}}},[t._v(t._s(t.text))])],1)]),t._v(" "),o("div",{staticClass:"dialog-footer"},[o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:t.bindNewPhone}},[t._v("提 交")]),t._v(" "),o("el-button",{on:{click:t.handleClose}},[t._v("取 消")])],1)])]),t._v(" "),o("Verify",{ref:"verify",attrs:{captchaType:"blockPuzzle",imgSize:{width:"330px",height:"155px"}},on:{success:t.verifySuccess}})],1)}),[],!1,null,"5abf7d3a",null);e.default=component.exports}}]);