(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{490:function(e,t,r){var content=r(588);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(3).default)("357a28ea",content,!0,{sourceMap:!1})},587:function(e,t,r){"use strict";var o=r(490);r.n(o).a},588:function(e,t,r){(t=r(2)(!1)).push([e.i,'.settled-wrapper[data-v-6cd2697a]{background:#fff;padding:0 91px 44px 109px}.settled-wrapper .user-com-title[data-v-6cd2697a]{font-size:20px;color:#282828;text-align:center;line-height:30px;border-bottom:1px solid #efefef}.settled-wrapper .demo-ruleForm[data-v-6cd2697a]{margin-top:30px}.settled-wrapper .demo-ruleForm .el-form-item[data-v-6cd2697a]{margin-bottom:34px}.settled-wrapper .demo-ruleForm .el-input[data-v-6cd2697a]{width:330px;height:36px;line-height:36px}.settled-wrapper .demo-ruleForm .verifiCode[data-v-6cd2697a]{width:200px}.settled-wrapper .demo-ruleForm .code[data-v-6cd2697a]{width:96px;height:36px;line-height:36px;text-align:center;color:#e93323;border:1px solid #e93323;border-radius:4px;margin-left:14px;background:#fff}.settled-wrapper .demo-ruleForm .el-form-item__label[data-v-6cd2697a],.settled-wrapper .demo-ruleForm .text[data-v-6cd2697a]{color:#666}.settled-wrapper .demo-ruleForm .text-desc[data-v-6cd2697a]{font-size:12px;color:#999}.settled-wrapper .el-form-item[data-v-6cd2697a]{position:relative}.settled-wrapper .wenhao[data-v-6cd2697a]{display:inline-block;text-align:center;width:17px;height:17px;line-height:17px;font-size:14px;border-radius:50%;background:#e3e3e3;color:#fff;margin-left:4px;cursor:pointer}.settled-wrapper .agreement[data-v-6cd2697a]{color:#e93323;font-family:"PingFang SC";cursor:pointer}.settled-wrapper .demo-ruleForm[data-v-6cd2697a]  .el-checkbox__input.is-checked+.el-checkbox__label{color:#666}.hide .el-upload--picture-card[data-v-6cd2697a]{display:none}.protocolModal[data-v-6cd2697a]{width:100%;height:100%;background:rgba(0,0,0,.5);position:fixed;top:0;left:0;z-index:999}.protocolModal .protocolCount[data-v-6cd2697a]{width:900px;height:800px;position:absolute;top:50%;left:50%;margin-top:-350px;margin-left:-450px}.protocolModal .protocolCount .protocolMain[data-v-6cd2697a]{width:100%;height:710px;background:#fff;border-radius:6px;padding:0 32px}.protocolModal .protocolCount .protocolMain .title[data-v-6cd2697a]{padding:20px 0;text-align:center;color:#333;font-size:20px;font-weight:700}.protocolModal .protocolCount .protocolMain .content-main[data-v-6cd2697a]{color:#333;line-height:20px;overflow-y:auto;height:500px}.protocolModal .sureBbtn[data-v-6cd2697a]{text-align:center;margin-top:60px}.protocolModal .sureBbtn .el-button[data-v-6cd2697a]{width:180px;height:46px}',""]),e.exports=t},728:function(e,t,r){"use strict";r.r(t);r(239),r(5);var o=r(115),n=r.n(o),l=(r(25),r(4)),c=(r(26),r(156)),d={name:"merchantSettled",auth:"guest",components:{Verify:r(157).a},mixins:[c.a],data:function(){var e=this;return{upLoadUrl:"/api/upload/image/file",imgUrl:[],pics:[],tables:{tableData:[],currentPage:1,total:0,page:1,limit:10,tableLoading:!1},ruleForm:{name:"",username:"",phone:"",yanzhengma:"",classification:"",type:"",images:[]},dialogImageUrl:"",dialogVisible:!1,hideUpload:!1,checked:!1,showProtocal:!1,isShowCode:!1,codeVal:"",codeUrl:"",keyCode:"",codeKey:"",validate:!1,array:[],typeArray:[],intention_id:"",title:"入驻协议",agreement:"",isSettled:!1,rules:{name:[{required:!0,message:"请输入商户名称",trigger:"blur"},{min:3,max:15,message:"长度在 3 到 15 个字符",trigger:"blur"}],username:[{required:!0,message:"请输入用户姓名",trigger:"blur"},{min:2,max:5,message:"长度在 2 到 5 个字符",trigger:"blur"}],yanzhengma:[{required:!0,message:"请输入验证码",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",validator:function(t,r,o){""==r?o(new Error("请输入手机号")):e.isCellPhone(r)?o():o(new Error("请输入正确的手机号!"))},trigger:"blur"}],classification:[{required:!0,message:"请选择商户分类",trigger:"change"}],type:[{required:!0,message:"请选择店铺类型",trigger:"change"}]},uploadLimit:10,currentLimit:10}},fetch:function(e){var t=e.store;t.commit("isBanner",!1),t.commit("isHeader",!0),t.commit("isFooter",!0)},head:function(){return{title:"入驻申请-"+this.$store.state.titleCon}},beforeMount:function(){this.$auth.loggedIn||this.$store.commit("isLogin",!0),this.intention_id=this.$route.query.intention_id,this.getClassfication(),this.getTypeArray(),this.intention_id&&this.getDetails(this.intention_id)},mounted:function(){},methods:{isCellPhone:function(e){return!!/^1(3|4|5|6|7|8)\d{9}$/.test(e)},getDetails:function(e){var t=this,r=this;r.$axios.get("/api/intention/detail/"+e).then((function(e){var data=e.data;t.ruleForm={name:data.mer_name,username:data.name,phone:data.phone,yanzhengma:"",classification:data.merchant_category_id,type:data.mer_type_id},t.imgUrl=data.images,t.currentLimit=t.uploadLimit-t.imgUrl.length||-1,t.checked=!0})).catch((function(e){r.$message.error(e)}))},getClassfication:function(){var e=this;e.$axios.get("/api/intention/cate").then((function(t){e.array=t.data})).catch((function(t){e.$message.error(t)}))},getTypeArray:function(){var e=this;e.$axios.get("/api/intention/type").then((function(t){e.typeArray=t.data})).catch((function(t){e.$message.error(t)}))},getAgreement:function(){var e=this;e.$axios.get("/api/config").then((function(t){e.agreement=t.data.sys_intention_agree,e.title="入驻协议",e.showProtocal=!0,e.isSettled=!0})).catch((function(t){e.$message.error(t)}))},getStoreType:function(){var e=this;e.$axios.get("/api/agreement/sys_merchant_type").then((function(t){e.agreement=t.data.sys_merchant_type,e.title="店铺类型说明",e.showProtocal=!0,e.isSettled=!1})).catch((function(t){e.$message.error(t)}))},resetForm:function(e){this.$refs[e].resetFields()},again:function(){this.getcaptcha()},getcaptcha:function(){var e=this;e.$axios.get("/api/captcha").then((function(t){e.codeUrl=data.data.captcha,e.codeVal=data.data.code,e.codeKey=data.data.key,e.isShowCode=!0})).catch((function(t){e.$message.error(t)}))},code:function(data){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((r=e).ruleForm.phone){t.next=3;break}return t.abrupt("return",r.$message.error("请填写手机号码"));case 3:if(/^1(3|4|5|7|8|9|6)\d{9}$/i.test(r.ruleForm.phone)){t.next=5;break}return t.abrupt("return",r.$message.error("请输入正确的手机号码"));case 5:e.$axios.post("/api/auth/verify",{phone:r.ruleForm.phone,type:"intention",captchaType:"blockPuzzle",captchaVerification:data.captchaVerification}).then((function(e){r.$message.success(e.message),r.sendCode()})).catch((function(e){r.$message.error(e)}));case 6:case"end":return t.stop()}}),t)})))()},onSubmit:function(){var e=this;if(!this.$auth.loggedIn)return n.a.warning("请登录");if(e.validateForm()&&e.validate){var t={phone:e.ruleForm.phone,mer_name:e.ruleForm.name,name:e.ruleForm.username,code:e.ruleForm.yanzhengma,merchant_category_id:e.ruleForm.classification,mer_type_id:e.ruleForm.type,images:e.imgUrl.concat(e.pics)};e.intention_id?e.$axios.post("/api/intention/update/"+e.intention_id,t).then((function(t){e.$message.success(t.message),e.$router.push({path:"/user/settle_record",query:{type:1}})})).catch((function(t){e.$message.error(t)})):e.$axios.post("/api/intention/create",t).then((function(t){e.$message.success(t.message),e.$router.push({path:"/user/settle_record",query:{type:1}})})).catch((function(t){e.$message.error(t)}))}},validateForm:function(){var e=this.ruleForm;return e.name?e.username?e.phone?/^1(3|4|5|7|8|9|6)\d{9}$/i.test(e.phone)?e.yanzhengma?e.classification?this.checked?this.isShowCode&&!this.codeVal?n.a.error("请填写图片验证码"):(this.validate=!0,!0):n.a.error("请勾选并同意入驻协议"):n.a.error("请选择商户分类"):n.a.error("请填写验证码"):n.a.error("请输入正确的手机号码"):n.a.error("请输入手机号"):n.a.error("请输入用户姓名"):n.a.error("请输入商户名称")},beforeAvatarUpload:function(e){var t="image/jpg"===e.type||"image/png"===e.type||"image/jpeg"===e.type,r=e.size/1024/1024<=5;return t||this.$message.error("上传图片只能为jpg/jpeg或png格式"),r||this.$message.error("上传图片大小不能超过5MB"),t&&r},handleExceed:function(){this.$message.warning("最多上传10张图片")},handleRemove:function(e,t){var r=this;this.pics=[],t.forEach((function(e){r.pics.push(e.response.data.url)})),this.currentLimit=this.uploadLimit-this.pics.length-this.imgUrl.length||-1},handleRemove1:function(e){this.imgUrl.splice(e,1),this.currentLimit=this.uploadLimit-this.imgUrl.length||-1},handleError:function(e,t,r){},handleSuccess:function(e){200===e.status?this.pics.push(e.data.path):400===e.status&&this.$message.error(e.msg)},getVerify:function(){return this.ruleForm.phone?/^1(3|4|5|7|8|9|6)\d{9}$/i.test(this.ruleForm.phone)?void this.$refs.verify.show():this.$message.error("请输入正确的手机号码"):this.$message.error("请填写手机号码")},verifySuccess:function(e){this.closeModel(e)},closeModel:function(e){this.isShow=!1,this.code(e)}}},m=(r(587),r(6)),component=Object(m.a)(d,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"settled-wrapper wrapper_1200"},[r("div",{staticClass:"user-com-title"},[e._v("\n    入驻申请\n  ")]),e._v(" "),r("div",{staticClass:"settled-main"},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"},nativeOn:{submit:function(e){e.preventDefault()}}},[r("el-form-item",{attrs:{label:"商户名称：",prop:"name"}},[r("el-input",{attrs:{placeholder:"请输入商户名称"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"用户姓名：",prop:"username"}},[r("el-input",{attrs:{placeholder:"请输入用户姓名"},model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"手机号：",prop:"phone"}},[r("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"验证码：",prop:"yanzhengma"}},[r("el-input",{staticClass:"verifiCode",attrs:{placeholder:"请输入验证码"},model:{value:e.ruleForm.yanzhengma,callback:function(t){e.$set(e.ruleForm,"yanzhengma",t)},expression:"ruleForm.yanzhengma"}}),e._v(" "),r("button",{staticClass:"code font-color",class:!0===e.disabled?"on":"",attrs:{disabled:e.disabled},on:{click:e.getVerify}},[e._v("\n          "+e._s(e.text)+"\n        ")])],1),e._v(" "),e.isShowCode?r("el-form-item",{attrs:{label:"图片验证码："}},[r("el-input",{staticClass:"verifiCode",attrs:{placeholder:"请输入验证码"},model:{value:e.codeVal,callback:function(t){e.codeVal=t},expression:"codeVal"}}),e._v(" "),r("span",{staticClass:"imageCode",on:{click:e.again}},[r("img",{attrs:{src:e.codeUrl,alt:""}})])],1):e._e(),e._v(" "),r("el-form-item",{attrs:{label:"商户分类：",prop:"classification"}},[r("el-select",{attrs:{placeholder:"请选择商户分类"},model:{value:e.ruleForm.classification,callback:function(t){e.$set(e.ruleForm,"classification",t)},expression:"ruleForm.classification"}},e._l(e.array,(function(e,t){return r("el-option",{key:t,attrs:{label:e.category_name,value:e.merchant_category_id}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"店铺类型：",prop:"type"}},[r("el-select",{attrs:{placeholder:"请选择店铺类型"},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}},e._l(e.typeArray,(function(e,t){return r("el-option",{key:t,attrs:{label:e.type_name,value:e.mer_type_id}})})),1),e._v(" "),r("span",{staticClass:"iconfont wenhao",on:{click:e.getStoreType}},[e._v("?")])],1),e._v(" "),r("el-form-item",{attrs:{label:"营业执照："}},[r("div",{staticClass:"text"},[e._v("\n          请上传营业执照及行业相关资质证明图片\n          "),r("span",{staticClass:"text-desc"},[e._v("(图片最多可上传10张， 单张图片不超过5M， 图片格式支持JPG、PNG、JPEG)")])]),e._v(" "),r("div",{staticClass:"imageUrl"},e._l(e.imgUrl,(function(t,o){return r("ul",{key:o,staticClass:"el-upload-list el-upload-list--picture-card"},[r("li",{staticClass:"el-upload-list__item is-success",attrs:{tabindex:"0"}},[r("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:t,alt:""}}),e._v(" "),r("a",{staticClass:"el-upload-list__item-name"},[r("i",{staticClass:"el-icon-document"})]),e._v(" "),r("label",{staticClass:"el-upload-list__item-status-label"},[r("i",{staticClass:"el-icon-upload-success el-icon-check"})]),e._v(" "),r("i",{staticClass:"el-icon-close"}),r("i",{staticClass:"el-icon-close-tip"},[e._v("按 delete 键可删除")]),r("span",{staticClass:"el-upload-list__item-actions"},[r("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleRemove1(o)}}},[r("i",{staticClass:"el-icon-delete"})])])])])})),0),e._v(" "),r("el-upload",{attrs:{action:e.upLoadUrl,"list-type":"picture-card",limit:e.currentLimit,accept:"image/*","before-upload":e.beforeAvatarUpload,"on-success":e.handleSuccess,"on-remove":e.handleRemove,"on-exceed":e.handleExceed}},[r("i",{staticClass:"el-icon-plus"})]),e._v(" "),r("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),e._v(" "),r("div",[r("el-checkbox",{model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("已阅读并同意")]),e._v(" "),r("span",{staticClass:"agreement",on:{click:e.getAgreement}},[e._v("《入驻协议》")])],1),e._v(" "),r("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[r("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("提交申请")])],1)],1)],1),e._v(" "),e.showProtocal?r("div",{staticClass:"protocolModal",on:{click:function(t){t.stopPropagation(),e.showProtocal=!1}}},[r("div",{staticClass:"protocolCount"},[r("div",{staticClass:"protocolMain"},[r("div",{staticClass:"title"},[e._v(e._s(e.title))]),e._v(" "),r("div",{staticClass:"content"},[r("div",{staticClass:"content-main",domProps:{innerHTML:e._s(e.agreement)}})]),e._v(" "),e.isSettled?r("div",{staticClass:"sureBbtn"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showProtocal=!1,e.checked=!0}}},[e._v("同意并继续")])],1):r("div",{staticClass:"sureBbtn"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showProtocal=!1}}},[e._v("我知道了")])],1)])])]):e._e(),e._v(" "),r("Verify",{ref:"verify",attrs:{captchaType:"blockPuzzle",imgSize:{width:"330px",height:"155px"}},on:{success:e.verifySuccess}})],1)}),[],!1,null,"6cd2697a",null);t.default=component.exports}}]);