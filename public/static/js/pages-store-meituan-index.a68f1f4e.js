(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-store-meituan-index"],{"10a3":function(t,e,n){"use strict";n.r(e);var r=n("d4e6"),o=n("f590");for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);n("fda8");var a=n("828b"),u=Object(a["a"])(o["default"],r["b"],r["c"],!1,null,"573a1def",null,!1,r["a"],void 0);e["default"]=u.exports},"6bc6":function(t,e,n){var r=n("e378");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var o=n("967d").default;o("70ddc562",r,!0,{sourceMap:!1,shadowMode:!1})},8306:function(t,e,n){"use strict";n("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("c223"),n("5ef2"),n("5c47"),n("a1c1"),n("795c"),n("c9b5"),n("bf0f"),n("ab80");var r=n("b69b"),o=n("f87d"),i=n("6647"),a=n("a9c8"),u=n("8f59"),d={data:function(){return{amount:"",id:0,store:{},pay_type:"routine",mer_id:null,userinfo:{},user_deduction:!1,is_pay:null,use_amount:0,target:"",pvRatio:"",countdownTime:"00:15:08",productTotal:"25.20",serviceFee:"1.26",discountAmount:"0.00",finalAmount:"26.46",pointsReward:"1.52",coinReward:"26.46",hasDiscount:!0,isPayButtonDisabled:!1,FormData:{}}},computed:(0,a.configMap)({hide_mer_status:1,recommend_switch:0,navigation:{}},(0,u.mapGetters)(["isLogin","viewColor"])),onLoad:function(t){this.FormData=t,t.phone&&(this.phone=t.phone),t.tradeNo&&(this.trade_no=t.tradeNo),t.orderId&&(this.id=t.orderId),this.startCountdown(),this.loginMobile()},mounted:function(){this.startCountdown()},methods:{loginMobile:function(){var t=this,e=this;(0,i.loginMobile)({phone:e.phone,sms_code:1234,user_type:"h5"}).then((function(n){var r=n.data;e.$store.commit("LOGIN",{token:r.token,time:r.exp}),e.$store.commit("SETUID",r.user.uid),e.$store.commit("UPDATE_USERINFO",r.user),t.getOrder(t.id)})).catch((function(t){e.$util.Tips({title:t})}))},getOrder:function(t){var e=this;(0,r.getOrderDetail)(t).then((function(t){e.store=t.data.store,e.productTotal=t.data.pay_price,e.finalAmount=t.data.pay_price,e.mer_id=t.data.mer_id,t.data.create_time?e.startCountdownFromCreateTime(t.data.create_time):e.startCountdown()}))},handleAmountChange:function(){this.user_deduction&&this.getConfirm()},changeDeduction:function(t){this.user_deduction=!this.user_deduction,this.getConfirm()},getQueryString:function(t,e){for(var n=t.split("?"),r=n[1].split("&"),o=0;o<r.length;o++){var i=r[o].split("=");if(i[0]==e)return i[1]}},getConfirm:function(){var t=this,e={user_deduction:this.user_deduction,money:this.amount,use_integral:!1};(0,o.userDeduction)(e).then((function(e){t.is_pay=e.data.finalAmount,t.use_amount=e.data.use_deduction})).catch((function(e){uni.showToast({title:"金额不能为空",icon:"none"}),t.user_deduction=!1}))},getUserInfo:function(){var t=this;(0,i.getUserInfo)().then((function(e){t.userinfo=e.data}))},tofied:function(){var t=this.id,e=this.pvRatio||this.store.commission_rate;uni.navigateTo({url:"/pages/store/life/friend?id=".concat(t,"&pvRatio=").concat(e)})},goPay:function(){var t=this;this.isPayButtonDisabled||(this.isPayButtonDisabled=!0,(0,r.meituanPay)({phone:this.phone,trade_no:this.trade_no,pay_type:"routine",is_app:1}).then((function(e){if(e.data.result&&e.data.result.config){var n=e.data.result.config;t.isWeixinBrowser()?t.onBridgeReady(n):window.location.href=e.data.result.mweb_url||""}"success"==e.data.result.status?uni.showToast({title:"支付成功",icon:"success"}):uni.showToast({title:e.message||"支付参数错误",icon:"none"})})).catch((function(e){uni.showToast({title:e||"创建订单失败",icon:"none"}),t.isPayButtonDisabled=!1})))},isWeixinBrowser:function(){var t=navigator.userAgent.toLowerCase();return-1!==t.indexOf("micromessenger")},onBridgeReady:function(t){var e=this;"undefined"===typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",(function(){return e.callWeixinJSBridge(t)}),!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",(function(){return e.callWeixinJSBridge(t)})),document.attachEvent("onWeixinJSBridgeReady",(function(){return e.callWeixinJSBridge(t)}))):this.callWeixinJSBridge(t)},callWeixinJSBridge:function(t){var e=this.id;WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:t.appId,timeStamp:t.time_stamp,nonceStr:t.nonce_str,package:t.package,signType:t.signType||"RSA",paySign:t.pay_sign},(function(t){"get_brand_wcpay_request:ok"==t.err_msg?(uni.showToast({title:"支付成功",icon:"success"}),setTimeout((function(){uni.redirectTo({url:"/pages/store/life/merchant?id=".concat(e)})}),1e3)):"get_brand_wcpay_request:cancel"==t.err_msg?(uni.showToast({title:"您已取消支付",icon:"none"}),setTimeout((function(){uni.redirectTo({url:"/pages/store/life/merchant?id=".concat(e)})}),2e3)):(uni.showToast({title:"支付失败",icon:"none"}),setTimeout((function(){uni.redirectTo({url:"/pages/store/life/merchant?id=".concat(e)})}),2e3))})),s},startCountdown:function(){var t=this;this.countdownInterval&&clearInterval(this.countdownInterval);var e=908;this.updateCountdownDisplay(e),this.countdownInterval=setInterval((function(){if(e--,e<=0)return clearInterval(t.countdownInterval),uni.showToast({title:"支付超时",icon:"none"}),void setTimeout((function(){uni.navigateBack()}),1500);t.updateCountdownDisplay(e)}),1e3)},startCountdownFromCreateTime:function(t){var e=this;this.countdownInterval&&clearInterval(this.countdownInterval);var n=new Date(t.replace(/-/g,"/")),r=new Date,o=Math.floor((r-n)/1e3),i=900-o;if(i<=0)return this.countdownTime="00:00",void uni.showToast({title:"支付已超时",icon:"none"});this.updateCountdownDisplay(i),this.countdownInterval=setInterval((function(){if(i--,i<=0)return clearInterval(e.countdownInterval),uni.showToast({title:"支付超时",icon:"none"}),void setTimeout((function(){uni.navigateBack()}),1500);e.updateCountdownDisplay(i)}),1e3)},updateCountdownDisplay:function(t){var e=Math.floor(t/60),n=t%60;this.countdownTime="".concat(e.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"))},switchAccount:function(){uni.showToast({title:"切换商家账户",icon:"none"})}},beforeDestroy:function(){this.countdownInterval&&clearInterval(this.countdownInterval)}};e.default=d},b69b:function(t,e,n){"use strict";n("6a54");var r=n("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.getOrderDetail=function(t){return o.default.get("order/mtdetail/"+t)},e.meituanPay=function(t){return o.default.post("meituan/meituan_pay",t)};var o=r(n("64b7"))},d4e6:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){}));var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"container"},[n("v-uni-view",{staticClass:"pay-header"},[n("v-uni-view",{staticClass:"pay-title"},[t._v("请支付")]),n("v-uni-view",{staticClass:"pay-countdown"},[t._v("剩余支付时间: "+t._s(t.countdownTime))])],1),n("v-uni-view",{staticClass:"payment-details"},[n("v-uni-view",{staticClass:"detail-title"},[t._v("支付明细")]),n("v-uni-view",{staticClass:"detail-item"},[n("v-uni-text",[t._v("商品总计")]),n("v-uni-text",[t._v("¥"+t._s(t.productTotal))])],1),n("v-uni-view",{staticClass:"total-amount"},[n("v-uni-text",[t._v("实付")]),n("v-uni-text",{staticClass:"amount"},[t._v("¥"+t._s(t.finalAmount))])],1)],1),t._e(),n("v-uni-view",{staticClass:"payment-method"},[n("v-uni-view",{staticClass:"method-item selected"},[n("v-uni-view",{staticClass:"method-icon wechat-icon"},[n("v-uni-text",{staticClass:"iconfont icon-weixinzhifu"})],1),n("v-uni-view",{staticClass:"method-name"},[t._v("微信支付")]),n("v-uni-view",{staticClass:"method-selected"},[n("v-uni-text",{staticClass:"iconfont icon-xuanzhong1"})],1)],1)],1),n("v-uni-view",{staticClass:"pay-button-container"},[n("v-uni-button",{staticClass:"pay-button",attrs:{disabled:t.isPayButtonDisabled},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goPay.apply(void 0,arguments)}}},[t._v("¥"+t._s(t.finalAmount)+" 继续支付")])],1)],1)},o=[]},e378:function(t,e,n){var r=n("c86c");e=r(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */\r\n/* 整体容器 */.container[data-v-573a1def]{display:flex;flex-direction:column;background-color:#f7f7f7;min-height:100vh;padding:0;box-sizing:border-box}\r\n/* 顶部支付信息 */.pay-header[data-v-573a1def]{background-color:#fff;padding:%?30?% %?40?%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;border-bottom:1px solid #f0f0f0}.pay-title[data-v-573a1def]{font-size:%?36?%;font-weight:700;color:#333}.pay-countdown[data-v-573a1def]{font-size:%?28?%;color:#ff5722}\r\n/* 支付详情 */.payment-details[data-v-573a1def]{background-color:#fff;margin-top:%?20?%;padding:%?30?% %?40?%}.detail-title[data-v-573a1def]{font-size:%?30?%;color:#333;margin-bottom:%?20?%;font-weight:700}.detail-item[data-v-573a1def]{display:flex;justify-content:space-between;margin-bottom:%?20?%;font-size:%?28?%;color:#666}.discount-item[data-v-573a1def]{color:#ff5722}.discount-amount[data-v-573a1def]{color:#ff5722}.total-amount[data-v-573a1def]{display:flex;justify-content:space-between;padding-top:%?20?%;border-top:1px solid #f0f0f0;font-size:%?30?%;color:#333;font-weight:700}.amount[data-v-573a1def]{font-size:%?34?%;color:#333}\r\n/* 消费奖励 */.reward-section[data-v-573a1def]{background-color:#fff;margin-top:%?20?%;padding:%?30?% %?40?%}.reward-title[data-v-573a1def]{font-size:%?30?%;color:#333;margin-bottom:%?20?%;font-weight:700}.reward-item[data-v-573a1def]{display:flex;justify-content:space-between;margin-bottom:%?20?%;font-size:%?28?%;color:#666}.reward-value[data-v-573a1def]{color:#07c160}\r\n/* 支付方式 */.payment-method[data-v-573a1def]{background-color:#fff;margin-top:%?20?%;padding:%?30?% %?40?%}.method-item[data-v-573a1def]{display:flex;flex-direction:row;align-items:center;padding:%?20?% 0}.method-icon[data-v-573a1def]{width:%?60?%;height:%?60?%;display:flex;justify-content:center;align-items:center;margin-right:%?20?%}.wechat-icon[data-v-573a1def]{color:#07c160;font-size:%?40?%}.method-name[data-v-573a1def]{flex:1;font-size:%?28?%;color:#333}.method-selected[data-v-573a1def]{color:#07c160;font-size:%?40?%}\r\n/* 支付按钮 */.pay-button-container[data-v-573a1def]{position:fixed;bottom:0;left:0;right:0;padding:%?20?% %?40?%;background-color:#fff;box-shadow:0 %?-2?% %?10?% rgba(0,0,0,.05)}.pay-button[data-v-573a1def]{width:100%;height:%?90?%;line-height:%?90?%;font-size:%?32?%;border-radius:%?45?%;background-color:#07c160;color:#fff;text-align:center\r\n  /* 添加禁用状态样式 */}.pay-button[disabled][data-v-573a1def]{background-color:#ccc;opacity:.8}\r\n/* 其他样式保留 */',""]),t.exports=e},f590:function(t,e,n){"use strict";n.r(e);var r=n("8306"),o=n.n(r);for(var i in r)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(i);e["default"]=o.a},f87d:function(t,e,n){"use strict";n("6a54");var r=n("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.applyInvoiceApi=function(t,e){return o.default.post("order/receipt/".concat(t),e)},e.cartDel=function(t){return o.default.post("user/cart/delete",t)},e.cartProductAttr=function(t){return o.default.get("store/product/get_attr_value/".concat(t))},e.changeCartNum=function(t,e){return o.default.post("user/cart/change/"+t,e)},e.createOrder=function(t){return o.default.post("v2/order/create",t,{noAuth:!0})},e.createPay=function(t){return o.default.post("order/offline/create",t)},e.develiveryDetail=function(t){return o.default.get("order/delivery/".concat(t))},e.express=function(t){return o.default.post("order/express/"+t)},e.expressList=function(){return o.default.get("common/express")},e.findFriends=function(t){return o.default.get("user/find_friends?phone="+t)},e.getCallBackUrlApi=function(t){return o.default.get("common/pay_key/"+t,{},{noAuth:!0})},e.getCartCounts=function(){return o.default.get("user/cart/count")},e.getCartList=function(){return o.default.get("user/cart/lst")},e.getCouponsOrderPrice=function(t,e){return o.default.get("coupons/order/"+t,e)},e.getOfflineDetail=function(t){return o.default.get("order/offline/detail/"+t)},e.getOfflineOrderList=function(t){return o.default.get("order/offline/list",t)},e.getOrderConfirm=function(t){return o.default.post("v2/order/check",t)},e.getOrderDetail=function(t){return o.default.get("order/detail/"+t)},e.getOrderList=function(t){return o.default.get("order/list",t)},e.getPayOrder=function(t){return o.default.get("order/status/"+t)},e.getReceiptOrder=function(t){return o.default.get("user/receipt/order/"+t)},e.groupOrderDetail=function(t){return o.default.get("order/group_order_detail/"+t)},e.groupOrderList=function(t){return o.default.get("order/group_order_list",t,{noAuth:!0})},e.integralOrderPay=function(t,e){return o.default.post("order/points/pay/"+t,e)},e.ordeRefundReason=function(){return o.default.get("order/refund/reason")},e.orderAgain=function(t){return o.default.post("user/cart/again",t)},e.orderComment=function(t,e){return o.default.post("reply/"+t,e)},e.orderConfirm=function(t){return o.default.post("order/check",t)},e.orderCreate=function(t){return o.default.post("order/create",t,{noAuth:!0})},e.orderData=function(){return o.default.get("order/number")},e.orderDel=function(t){return o.default.post("order/del/"+t)},e.orderPay=function(t,e){return o.default.post("order/pay/"+t,e)},e.orderProduct=function(t){return o.default.get("reply/product/"+t)},e.orderRefundVerify=function(t){return o.default.post("order/refund/verify",t)},e.orderTake=function(t){return o.default.post("order/take/"+t)},e.postOrderComputed=function(t,e){return o.default.post("/order/computed/"+t,e)},e.presellOrderPay=function(t,e){return o.default.post("presell/pay/"+t,e)},e.receiptOrder=function(t){return o.default.get("user/receipt/order",t)},e.refundApply=function(t,e){return o.default.post("refund/apply/"+t,e,{noAuth:!0})},e.refundBackGoods=function(t,e){return o.default.post("refund/back_goods/"+t,e,{noAuth:!0})},e.refundBatch=function(t){return o.default.get("refund/batch_product/"+t,{noAuth:!0})},e.refundCancelApi=function(t){return o.default.post("refund/cancel/".concat(t))},e.refundDel=function(t){return o.default.post("refund/del/"+t,{noAuth:!0})},e.refundDetail=function(t){return o.default.get("refund/detail/"+t,{noAuth:!0})},e.refundExpress=function(t){return o.default.get("refund/express/"+t,{noAuth:!0})},e.refundList=function(t){return o.default.get("refund/list",t,{noAuth:!0})},e.refundMessage=function(){return o.default.get("common/refund_message",{noAuth:!0})},e.refundOrderExpress=function(t,e){return o.default.get("server/".concat(t,"/refund/express/").concat(e))},e.refundProduct=function(t,e){return o.default.get("refund/product/"+t,e,{noAuth:!0})},e.unOrderCancel=function(t){return o.default.post("order/cancel/"+t)},e.userDeduction=function(t){return o.default.post("order/offline/check",t)},e.verifyCode=function(t){return o.default.get("order/verify_code/"+t)},n("c223");var o=r(n("64b7"))},fda8:function(t,e,n){"use strict";var r=n("6bc6"),o=n.n(r);o.a}}]);